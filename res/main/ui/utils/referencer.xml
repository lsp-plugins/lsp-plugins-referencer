<plugin resizable="true">
	<grid rows="2" cols="2">
		<!-- Main panel -->
		<cell rows="2">
			<vbox>
				<!-- Switch between sources -->
				<label text="labels.source" />
				<ui:with id="source" hfill="true">
					<button text="lists.referencer.source.mix" value="0" />
					<button text="lists.referencer.source.reference" value="1" />
					<button text="lists.referencer.source.both" value="2" />
				</ui:with>
	
				<!-- Mode for stereo version -->
				<ui:if test="ex :mode">
					<label text="labels.mode" />
					<ui:with id="mode" hfill="true">
						<button text="lists.referencer.mode.stereo" value="0" />
						<button text="lists.referencer.mode.inverse_stereo" value="1" />
						<button text="lists.referencer.mode.mono" value="2" />
						<button text="lists.referencer.mode.side" value="3" />
						<button text="lists.referencer.mode.sides" value="4" />
						<button text="lists.referencer.mode.mid_side" value="5" />
						<button text="lists.referencer.mode.side_mid" value="6" />
						<button text="lists.referencer.mode.left_only" value="7" />
						<button text="lists.referencer.mode.left" value="8" />
						<button text="lists.referencer.mode.right" value="9" />
						<button text="lists.referencer.mode.right_only" value="10" />
					</ui:with>
				</ui:if>
				
				<void vexpand="true" />
	
				<!-- Playback control -->
				<hbox>
					<button id="play" text="icons.playback.play" font.name="lsp-icons" font.size="20" value="0" />
					<button id="play" text="icons.playback.stop" font.name="lsp-icons" font.size="20" value="1" />
					<void hexpand="true" />
				</hbox>
				<!-- Playback matrix -->
				<grid rows="5" cols="5">
					<label text="labels.sedit.sample_num" />
					<cell cols="4">
						<label text="labels.sedit.loop" />
					</cell>
					
					<ui:for id="i" first="1" count="4">
						<label text="${i}" />
						<ui:for id="j" first="1" count="4">
							<button ui:id="play_matrix_${i}_${j}" text="${j}"/>
						</ui:for>
					</ui:for>
				</grid>
				
				<!-- Playback loop -->
				<ui:for id="si" first="1" count="4">
					<asample
						active="false"
						hexpand="true"
						id="sf_${si}"
						mesh_id="loop_m"
						length=":loop_l"
						status="0"
						loop.enabled="false"
						play.position=":loop_p"
						width.min="192"
						height.min="96"
						load.preview="true"
						visibility=":pssel ieq ${si}" />
					/>
				</ui:for>
			</vbox>
		</cell>
		
		<!-- Tab control for different operations -->
		<tabs id="section" expand="true">
			<!-- Samples -->
			<cgroup id="ssel" expand="true">
				<ui:for id="si" first="1" count="4">
					<vbox>
						<hbox width.min="650" height.min="256" expand="true">
							<!-- Sample loader/editor -->
							<asample
								expand="true"
								id="sf_${si}"
								mesh_id="fm_${si}"
								path_id="_ui_dlg_sample_path"
								length=":fl_${si}"
								status=":fs_${si}"
								loop.enabled="true"
								loop.color="loop_color"
								loop.border.color="loop_border_color"
								loop.begin="(:ls_${si} ige 2) ? ((:ls_${si} ige 3) ? :lb_${si}_4 : :lb_${si}_3) : ((:ls_${si} ige 1) ? :lb_${si}_2 : :lb_${si}_1)"
								loop.end="(:ls_${si} ige 2) ? ((:ls_${si} ige 3) ? :le_${si}_4 : :le_${si}_3) : ((:ls_${si} ige 1) ? :le_${si}_2 : :le_${si}_1)"
								play.position="(:ls_${si} ige 2) ? ((:ls_${si} ige 3) ? :pp_${si}_4 : :pp_${si}_3) : ((:ls_${si} ige 1) ? :pp_${si}_2 : :pp_${si}_1)"
								width.min="320"
								height.min="160"
								load.preview="true" />
								
							<!-- Sample list -->
							<void bg.color="bg_graph" pad.h="2" hreduce="true" visibility="(:fs_${si} ine 1)"/>
		
							<vbox vexpand="true" visibility="(:fs_${si} ine 1)">
								<void bg.color="bg_graph" pad.v="2" vreduce="true"/>
								<afolder id="sf_${si}" expand="true" width.min="199"/>
								<void bg.color="bg_graph" pad.v="2" vreduce="true"/>
		
								<ui:with fill="true">
									<hbox pad.h="6" pad.v="4" spacing="4" bg.color="bg_schema">
										<ui:with height="22">
											<anavigator id="sf_${si}" text="icons.navigation_big.first_alt" action="first"/>
											<anavigator id="sf_${si}" text="icons.navigation_big.last_alt" action="last"/>
											<void hexpand="true"/>
											<anavigator id="sf_${si}" text="icons.navigation_big.previous" action="previous"/>
											<anavigator id="sf_${si}" text="icons.navigation_big.next" action="next"/>
											<void hexpand="true"/>
		
											<anavigator id="sf_${si}" text="icons.random.dice_fill" action="random"/>
											<void hexpand="true"/>
											<anavigator id="sf_${si}" text="icons.actions.cancel_alt" action="clear"/>
										</ui:with>
									</hbox>
								</ui:with>
							</vbox>
						</hbox>
							
						<grid rows="4" cols="9" transpose="true">
							<cell rows="2" >
								<label text="labels.gain" />
							</cell>	
							<knob id="sg_${si}" />
							<value id="sg_${si}" />
						
							<ui:for id="li" first="1" count="4">
								<cell cols="2">
									<button id="ls_${si}" text="lists.referencer.loop.${li}" value="${:li - 1}" />
								</cell>
									
								<label text="labels.sedit.loop_start" />
								<knob id="lb_${si}_${li}" max=":fl_${si}" />
								<value id="lb_${si}_${li}" />
								
								<label text="labels.sedit.loop_end" />
								<knob id="le_${si}_${li}" max=":fl_${si}" />
								<value id="le_${si}_${li}" />
							</ui:for>
						</grid>
					</vbox>
				</ui:for>
			</cgroup>
			
			<!-- Spectral analysis -->
			<vbox>
				<graph width.min="640" height.min="256" expand="true" fill="true">
					<origin hpos="-1" vpos="-1" visibility="false"/>
	
					<!-- Secondary grid -->
					<ui:with color="graph_sec">
						<ui:for id="f" first="20" last="90" step="10">
							<marker v="${:f}"/>
							<marker v="${:f * 10}"/>
							<marker v="${:f * 100}"/>
						</ui:for>
						<marker v="20000"/>
						<ui:for id="g" first="-60" last="12" step="24">
							<marker v="${g} db" ox="1" oy="0"/>
						</ui:for>
	
						<!-- ui:for id="t" first="-42" last="-6" step="12">
							<marker v="${t} db" ox="1" oy="0" visibility=":zoom le -18 db"/>
						</ui:for>
						<ui:for id="t" first="-33" last="-15" step="6">
							<marker v="${t} db" ox="1" oy="0" visibility=":zoom le -33 db"/>
						</ui:for-->
					</ui:with>
	
					<!-- Primary Grid -->
					<ui:with color="graph_prim">
						<marker v="100"/>
						<marker v="1000"/>
						<marker v="10000"/>
	
						<marker v="0 db" ox="1" oy="0"/>
						<marker v="-24 db" ox="1" oy="0"/>
						<marker v="-48 db" ox="1" oy="0"/>
	
						<marker v="1" ox="2" oy="0" visibility="false"/>
						<marker v="24000" visibility="false"/>
					</ui:with>
	
					<!-- Meshes -->
					<ui:if test="ex :in_r">
						<mesh id="fftgr" xi="0" yi="1" color="left" fill.color="cyan" fill.color.a="0.9" color.a="0.5" fill="false" />
						<mesh id="fftgr" xi="0" yi="2" color="right" fill.color="cyan" fill.color.a="0.9" color.a="0.5" fill="false" />
						
						<mesh id="fftgr" xi="0" yi="3" color="left" fill.color="cyan" fill.color.a="0.9" color.a="0.5" fill="false" />
						<mesh id="fftgr" xi="0" yi="4" color="right" fill.color="cyan" fill.color.a="0.9" color.a="0.5" fill="false" />
					</ui:if>
					<ui:if test="!ex :in_r">
					</ui:if>
	
					<!-- Axis -->
					<axis ui:id="main_graph_ox" angle="0.0" min="10" max="24000" color="graph_prim" log="true" visibility="false"/>
					<axis angle="0.5" min="-72 db" max="24 db" color="graph_prim" log="true" visibility="false"/>
					<axis angle="0.5" min="-1" max="1" visibility="false"/>
	
					<!-- Text -->
					<ui:with ox="0" oy="2" y="0" halign="1" valign="1">
						<text x="10" text="graph.units.hz"/>
						<text x="20" text="20"/>
						<text x="30" text="30"/>
						<text x="50" text="50"/>
						<text x="100" text="100"/>
						<text x="200" text="200"/>
						<text x="300" text="300"/>
						<text x="500" text="500"/>
						<text x="1000" text="graph.values.x_k" text:value="1"/>
						<text x="2000" text="graph.values.x_k" text:value="2"/>
						<text x="3000" text="graph.values.x_k" text:value="3"/>
						<text x="5000" text="graph.values.x_k" text:value="5"/>
						<text x="10000" text="graph.values.x_k" text:value="10"/>
						<text x="20000" text="graph.values.x_k" text:value="20"/>
					</ui:with>
					<ui:for id="t" first="-60" last="12" step="12">
						<text x="10" y="${t} db" text="${t}" halign="1" valign="1"/>
					</ui:for>
					<text x="10" y="1" ox="0" oy="2" text="graph.units.db" halign="1" valign="-1"/>
					<!-- ui:with x="10" halign="1" valign="1" visibility=":zoom le -18 db">
						<text y="-42 db" text="-42"/>
						<text y="-30 db" text="-30"/>
						<text y="-18 db" text="-18"/>
						<text y="-6 db" text="-6"/>
					</ui:with>
					<ui:with x="10" halign="1" valign="1" visibility=":zoom le -33 db">
						<text y="-33 db" text="-33"/>
						<text y="-27 db" text="-27"/>
						<text y="-21 db" text="-21"/>
						<text y="-15 db" text="-33"/>
					</ui:with -->
				</graph>

				<!-- Bottom menu -->
				<hbox pad.l="6" pad.r="6" pad.t="4" pad.b="4" bg.color="bg_schema">
					<hbox spacing="8">
						<label text="labels.fft.window"/>
						<combo id="fftwnd" pad.r="15"/>
						<label text="labels.fft.tolerance"/>
						<combo id="ffttol" pad.r="15"/>
						<label text="labels.fft.envelope"/>
						<combo id="fftenv" pad.r="15"/>
						<label text="labels.metering.reactivity" />
						<knob id="react" scale.size="3" size="10" />
						<value id="react" sline="true" width="60"/>
					</hbox>
					<void hexpand="true"/>
				</hbox>
			</vbox>
			
			<!-- Dynamics -->
			<vbox>
				<graph width.min="640" height.min="256" expand="true" fill="true" visibility=":dmmode ine 4">
					<origin hpos="1" vpos="-1" visible="false"/>
					<!-- Additional grid -->
					<ui:for id="t" first="0" last="2" step="1">
						<marker ox="0" oy="1" v="${:t + 0.125}" color="graph_alt_2" visibility=":dmtime le 2.625" />
						<marker ox="0" oy="1" v="${:t + 0.375}" color="graph_alt_2" visibility=":dmtime le 2.625" />
						<marker ox="0" oy="1" v="${:t + 0.625}" color="graph_alt_2" visibility=":dmtime le 2.625" />
						<marker ox="0" oy="1" v="${:t + 0.875}" color="graph_alt_2" visibility=":dmtime le 2.625" />
					</ui:for>
					
					<ui:for id="t" first="0" last="6" step="1">
						<marker ox="0" oy="1" v="${:t + 0.25}" color="graph_alt_2" visibility=":dmtime le 5.25" />
						<marker ox="0" oy="1" v="${:t + 0.75}" color="graph_alt_2" visibility=":dmtime le 5.25" />
					</ui:for>
					
					<ui:for id="t" first="0" last="9" step="1">
						<marker ox="0" oy="1" v="${:t + 0.5}" color="graph_alt_1" visibility=":dmtime le 10.5" />
					</ui:for>
					
					<ui:with ox="1" oy="0" color="graph_alt_1">
						<marker v="6 db"/>
						<marker v="-6 db"/>
						<marker v="-18 db"/>
						<marker v="-30 db"/>
					</ui:with>

					<!-- Main grid -->
					<ui:for id="t" first="1" last="19" step="2">
						<marker v="${t}" ox="0" oy="1" color="graph_sec"/>
					</ui:for>
					<ui:for id="t" first="2" last="18" step="2">
						<marker v="${t}" ox="0" oy="1" color="graph_sec"/>
					</ui:for>

					<ui:with ox="1" oy="0" color="graph_sec">
						<marker v="0 db"/>
						<marker v="-12 db"/>
						<marker v="-24 db"/>
					</ui:with>

					<!-- Meshes -->
					<mesh id="dmmesh" width="2" xi="0" yi="1" color="orange" visibility=":dmsel ine 1"/>
					<mesh id="dmmesh" width="2" xi="0" yi="2" color="cyan" visibility=":dmsel ine 0"/>

					<!-- Axis -->
					<axis min="0" max=":dmtime" angle="1.0" log="false" color="graph_prim" visible="false"/>
					<axis min="-36 db" max="12 db" angle="0.5" log="true" color="graph_prim" visible="false"/>
					<axis min="0" max="1" angle="1.0" log="false" color="graph_prim" visible="false"/>

					<!-- Text -->
					<ui:with y="-36 db" halign="-1" valign="1" pgroup="0" priority="10">
						<ui:for id="t" first="0" last="2" step="1">
							<text x="${:t + 0.25}" text="${t}.25" color="graph_alt1" visibility=":dmtime le 2.625" />
							<text x="${:t + 0.75}" text="${t}.75" color="graph_alt1" visibility=":dmtime le 2.625" />
						</ui:for>
						<ui:for id="t" first="0" last="4" step="1">
							<text x="${:t + 0.5}" text="${t}.5" color="graph_alt1" visibility=":dmtime le 5.25" />
						</ui:for>
						<ui:for id="t" first="1" last="9" step="2">
							<text x="${t}" text="${t}" color="graph_prim" visibility=":dmtime le 10.5" />
						</ui:for>
						<ui:for id="t" first="0" last="18" step="2">
							<text x="${t}" text="${t}" color="graph_prim"/>
						</ui:for>
					</ui:with>
					
					<ui:with ox="2" x="1" halign="1" valign="1" color="graph_prim" pgroup="0" priority="10">
						<text y="6 db" text="6"/>
						<text y="0 db" text="0"/>
						<text y="-6 db" text="-6"/>
						<text y="-12 db" text="-12"/>
						<text y="-18 db" text="-18"/>
						<text y="-24 db" text="-24"/>
						<text y="-30 db" text="-30"/>
					</ui:with>
					
					<ui:with pgroup="0" priority="0" ox="2" x="1" halign="1" color="graph_prim">
						<text y="-36 db" text="graph.units.s" valign="1" />
						<text y="12 db" text="graph.units.db" valign="-1" />
					</ui:with>
				</graph>
				
				<!-- PSR graph -->
				<graph width.min="640" height.min="256" expand="true" fill="true" visibility=":dmmode ieq 4">
					<origin hpos="1" vpos="-1" visible="false"/>
					<!-- Additional grid -->
					<ui:for id="t" first="0" last="2" step="1">
						<marker ox="0" oy="1" v="${:t + 0.125}" color="graph_alt_2" visibility=":dmtime le 2.625" />
						<marker ox="0" oy="1" v="${:t + 0.375}" color="graph_alt_2" visibility=":dmtime le 2.625" />
						<marker ox="0" oy="1" v="${:t + 0.625}" color="graph_alt_2" visibility=":dmtime le 2.625" />
						<marker ox="0" oy="1" v="${:t + 0.875}" color="graph_alt_2" visibility=":dmtime le 2.625" />
					</ui:for>
					
					<ui:for id="t" first="0" last="6" step="1">
						<marker ox="0" oy="1" v="${:t + 0.25}" color="graph_alt_2" visibility=":dmtime le 5.25" />
						<marker ox="0" oy="1" v="${:t + 0.75}" color="graph_alt_2" visibility=":dmtime le 5.25" />
					</ui:for>
					
					<ui:for id="t" first="0" last="9" step="1">
						<marker ox="0" oy="1" v="${:t + 0.5}" color="graph_alt_1" visibility=":dmtime le 10.5" />
					</ui:for>
					
					<ui:with ox="1" oy="0" color="graph_alt_1">
						<ui:for id="y" first="0" last="2">
							<ui:for id="i" first="1" count="5">
								<marker v="${:y*6 + :i} db" />
							</ui:for>
						</ui:for>
					</ui:with>

					<!-- Main grid -->
					<ui:for id="t" first="1" last="19" step="2">
						<marker v="${t}" ox="0" oy="1" color="graph_sec"/>
					</ui:for>
					<ui:for id="t" first="2" last="18" step="2">
						<marker v="${t}" ox="0" oy="1" color="graph_sec"/>
					</ui:for>

					<ui:with ox="1" oy="0" color="graph_sec">
						<marker v="0 db"/>
						<marker v="6 db"/>
						<marker v="12 db"/>
					</ui:with>

					<!-- Meshes -->
					<mesh id="dmmesh" width="2" xi="0" yi="1" color="orange" visibility=":dmsel ine 1"/>
					<mesh id="dmmesh" width="2" xi="0" yi="2" color="cyan" visibility=":dmsel ine 0"/>

					<!-- Axis -->
					<axis min="0" max=":dmtime" angle="1.0" log="false" color="graph_prim" visible="false"/>
					<axis min="0 db" max="18 db" angle="0.5" log="true" color="graph_prim" visible="false"/>
					<axis min="0" max="1" angle="1.0" log="false" color="graph_prim" visible="false"/>

					<!-- Text -->
					<ui:with y="0 db" halign="-1" valign="1" pgroup="0" priority="10">
						<ui:for id="t" first="0" last="2" step="1">
							<text x="${:t + 0.25}" text="${t}.25" color="graph_alt1" visibility=":dmtime le 2.625" />
							<text x="${:t + 0.75}" text="${t}.75" color="graph_alt1" visibility=":dmtime le 2.625" />
						</ui:for>
						<ui:for id="t" first="0" last="4" step="1">
							<text x="${:t + 0.5}" text="${t}.5" color="graph_alt1" visibility=":dmtime le 5.25" />
						</ui:for>
						<ui:for id="t" first="1" last="9" step="2">
							<text x="${t}" text="${t}" color="graph_prim" visibility=":dmtime le 10.5" />
						</ui:for>
						<ui:for id="t" first="0" last="18" step="2">
							<text x="${t}" text="${t}" color="graph_prim"/>
						</ui:for>
					</ui:with>

					<ui:with ox="2" x="1" halign="1" valign="1" color="graph_prim" pgroup="0" priority="10">
						<ui:for id="i" first="1" last="16"> 
							<text y="${i} db" text="${i}" />
						</ui:for>
					</ui:with>
					
					<ui:with pgroup="0" priority="0" ox="2" x="1" halign="1" color="graph_prim">
						<text y="18 db" text="graph.units.db" valign="-1" />
						<text y="0 db" text="graph.units.s" valign="1" />
					</ui:with>
				</graph>
					
				<!-- Down panel -->
				<hbox pad.l="6" pad.r="6" pad.t="4" pad.b="4" bg.color="bg_schema">
					<!-- MIDI settings -->
					<combo id="dmsel" />
					<combo id="dmmode" />
						
					<knob id="dmtime" scale.size="3" size="10" pad.l="6"/>
					<value id="dmtime" width.min="48" same_line="true" fill="true" halign="-1" pad.r="12" />
					
					<void hexpand="true" />
				</hbox>
			</vbox>
		</tabs>
		
		<!-- Different common manipulations -->
		<group text="groups.post_filter">
			<grid rows="3" cols="7" spacing="2">
				<!-- Row 1 -->
				<ui:with hfill="true">
					<button id="pfsel" text="lists.referencer.filter.off" value="0" />
					<button id="pfsel" text="lists.referencer.filter.sub_bass" value="1" />
					<button id="pfsel" text="lists.referencer.filter.bass" value="2" />
					<button id="pfsel" text="lists.referencer.filter.low_mid" value="3" />
					<button id="pfsel" text="lists.referencer.filter.mid" value="4" />
					<button id="pfsel" text="lists.referencer.filter.high_mid" value="5" />
					<button id="pfsel" text="lists.referencer.filter.high" value="6" />
				</ui:with>
				
				<!-- Row 2 -->
				<cell rows="2">
					<vbox>
						<combo id="pfslope" />
						<combo id="pfmode" />
					</vbox>
				</cell>
				<cell rows="2"><void /></cell>
				<knob id="pfsub" />
				<knob id="pfbass" />
				<knob id="pflomid" />
				<knob id="pfmid" />
				<knob id="pfhimid" />
				
				<!-- Row 3 -->
				<value id="pfsub" />
				<value id="pfbass" />
				<value id="pflomid" />
				<value id="pfmid" />
				<value id="pfhimid" />
			</grid>
		</group>
	</grid>
</plugin>
